<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>MAL-Sync</title>
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
		<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
	</head>
  <body style="background: linear-gradient(to bottom, #032e45 0%,#9b7c91 100%);">
  	<div id="sidebar">
  		<div id="sidebar-inner">
  			<div id="header-inner" style="width: 100%; height: 100%; display: none;">
  				<div id="open-home" style="display: inline-block; color: white; line-height: 30px; padding: 0 10px; cursor: pointer;">
  					Home
  				</div>
  				<div id="open-changelog" style="display: inline-block; color: white; line-height: 30px; padding: 0 10px; cursor: pointer;">
  					Changelog
  				</div>
  			</div>
  		</div>
  	</div>
  	<div class="navbar-light mobile-nav" style="height: 0; overflow: hidden;">
  		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
  		  <span class="navbar-toggler-icon"></span>
  		</button>
  	</div>
  	<div id="content" class="container">
  	<noscript>
  		<div class="page noscript">
			<p style="color: white;"> For full functionality of this site it is necessary to enable JavaScript.</p>
			<style>
				#loading{
					display: none;
				}
			</style>
  		</div>
  	</noscript>
  	<div class="page-visibility center-wrap" id="loading">
    	<div class="loader"></div>
	</div>
	<div class="page center-wrap" id="home" style="display: none;">
	   	<div class="card text-center" style="
	   		border: 0;
	   		background-color: black;
	   		background-color: #0000001f;
	   		color: white;
	   		position: absolute;
	   		white-space: nowrap;
    		top: 50%;
    		left: 50%;
    		transform: translate(-50%, -50%);
    	">
	   	<div class="card-body">
	   	    <h1 class="card-title">MAL-Sync</h1>
	   	    <h2 class="card-text" style="font-size: 1rem; font-weight: 400; line-height: 1.5;">Integrates MyAnimeList into various sites, with auto episode tracking.</h2>
	   	    <br/>
	   	    <a href="https://github.com/lolamtisch/MALSync#readme" class="btn btn-primary">Github</a>
	   	  </div>
	   	</div>
	</div>
	<div class="page" id="changelog" style="display: none;">
		<div id="changelog-content" class="container">
			<div class="card">
				<div class="card-header">
					Current - Version 2018.9.24.1
				</div>
				<div class="list-group list-group-flush">
					<div class="list-group-item">
						Fixed issue with rapidvideo host.
					</div>
					<div class="list-group-item">
						Release Date: September 24th, 2018
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<canvas id="starCanvas" style="position: fixed; top: 0; left: 0; z-index: -1;">
	</canvas>
	<script type="text/javascript">
		var canvas = document.getElementById("starCanvas");
		var stars = [];
		var fps = 60;
		var frame = 0;
		var remainingScroll = 0;
		var running = 0;
		initStars();
		window.onresize = function() {
		  initStars();
		}
		var scrollTop = (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
		window.onscroll = function() {
			var scrollTopTemp = (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
			var scrollDistance = scrollTop - scrollTopTemp;
			scrollTop = scrollTopTemp;


			remainingScroll += scrollDistance;
		}
		function initStars(){
			canvas.width = document.body.clientWidth;
			canvas.height = document.body.clientHeight;
			var ctx = canvas.getContext("2d");

			if(!stars.length){
				for(var i = 0; i < 100; i++){
					var star = new Star();
					star.init();
					stars.push(star);
				}
			}else{
				for (var star of stars) {
					star.init();
				}
			}
			drawStars();
			if(!running){
				//setInterval(animate, 1000 / fps);
				requestAnimationFrame(animate);
				running++;
			}
			var speed = 0;
			function animate(){
				//console.log(speed);
				if(remainingScroll < 10 && remainingScroll > -10){
					speed = speed - 0.05;
					if(speed < 0) speed = 0;
				}else{
					speed = speed + 0.1;
					if(speed > 4) speed = 4;
					var scrollDistance = remainingScroll / (fps * 0.1);
					remainingScroll = remainingScroll - scrollDistance;
				}

				if(remainingScroll < 0){
					scrollDistance = 0 - speed;
				}else{
					scrollDistance = speed;
				}

				for (var star of stars) {
					star.animate();
					star.offset(0, scrollDistance/star.paralaxLevel);
				}
				drawStars();
				requestAnimationFrame(animate);
			}
			function drawStars(){
				frame++;
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				ctx.moveTo(0, 0);
				ctx.fillStyle="white";

				for (var star of stars) {
					ctx.fillRect(
						star.x,
						star.y,
						star.size,
						star.size
					);
				}
				ctx.stroke();
			}
		}

		function Star() {
			this.x = 0;
			this.y = 0;
			this.xSpeed = 0;
			this.ySpeed = 0;
			this.size = 1;
			this.paralaxLevel = 1;
			this.init = function(){
				this.x = Math.floor(Math.random() * canvas.width);
				this.y = Math.floor(Math.random() * canvas.height);
				this.size = Math.ceil(Math.random() * 3);
				var maxSpeed = 0.08/this.size;
				this.xSpeed = (Math.random() * (maxSpeed*2))-maxSpeed;
				this.ySpeed = (Math.random() * (maxSpeed*2))-maxSpeed;
				this.paralaxLevel = Math.ceil(Math.random() * 5)+3;
			}
			this.animate = function(){
				var maxSpeed = 0.08/this.size;
				if (frame % 100 == 99) {
					this.xSpeed += (Math.random() * 0.0004)-0.0002;
					this.ySpeed += (Math.random() * 0.0004)-0.0002;
				}
				if(this.xSpeed > maxSpeed){
					this.xSpeed = maxSpeed;
				}else if(this.xSpeed < (maxSpeed * -1)){
					this.xSpeed = maxSpeed * -1;
				}

				if(this.ySpeed > maxSpeed){
					this.ySpeed = maxSpeed;
				}else if(this.ySpeed < (maxSpeed * -1)){
					this.ySpeed = maxSpeed * -1;
				}
				//
				this.y += this.ySpeed;
				this.x += this.xSpeed;
				if(this.x > canvas.width){
					this.x += (canvas.width * -1)
				}else if(this.x < 0){
					this.x += canvas.width
				}
				if(this.y > canvas.height){
					this.y += (canvas.height * -1)
				}else if(this.y < 0){
					this.y += canvas.height
				}
			}
			this.offset = function(xOff, yOff){
				this.y += yOff;
				this.x += xOff;
			}
		}

		window.requestAnimFrame = (function(){
		  return  window.requestAnimationFrame       ||
		          window.webkitRequestAnimationFrame ||
		          window.mozRequestAnimationFrame    ||
		          function( callback ){
		            window.setTimeout(callback, 1000 / 60);
		          };
		})();
	</script>
  </body>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
  <link rel="stylesheet" type="text/css" href="bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="main.css">
  <script src='bootstrap.min.js'></script>
  <script src='notification.js'></script>
</html>
